import{e as ct}from"./uqr-DbKKXXO5.js";import{r as p}from"./react-DOu_sjnl.js";import{r as L}from"./react-dom-C5-jxJu5.js";var j=(t,e=[])=>({parts:(...r)=>{if(it(e))return j(t,r);throw new Error("createAnatomy().parts(...) should only be called once. Did you mean to use .extendWith(...) ?")},extendWith:(...r)=>j(t,[...e,...r]),rename:r=>j(r,e),keys:()=>e,build:()=>[...new Set(e)].reduce((r,o)=>Object.assign(r,{[o]:{selector:[`&[data-scope="${$(t)}"][data-part="${$(o)}"]`,`& [data-scope="${$(t)}"][data-part="${$(o)}"]`].join(", "),attrs:{"data-scope":$(t),"data-part":$(o)}}}),{})}),$=t=>t.replace(/([A-Z])([A-Z])/g,"$1-$2").replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[\s_]+/g,"-").toLowerCase(),it=t=>t.length===0,k=t=>typeof t=="object"&&t!==null,at=1,ft=9,lt=11,dt=t=>k(t)&&t.nodeType===at&&typeof t.nodeName=="string",X=t=>k(t)&&t.nodeType===ft,gt=t=>k(t)&&t===t.window,pt=t=>k(t)&&t.nodeType!==void 0,vt=t=>pt(t)&&t.nodeType===lt&&"host"in t;function yt(t){return X(t)?t:gt(t)?t.document:(t==null?void 0:t.ownerDocument)??document}function Y(t){var e;return vt(t)?Y(t.host):X(t)?t.defaultView??window:dt(t)?((e=t.ownerDocument)==null?void 0:e.defaultView)??window:window}function wt(t){let e=t.activeElement;for(;e!=null&&e.shadowRoot;){const r=e.shadowRoot.activeElement;if(r===e)break;e=r}return e}function tt(t,e){const{type:r,quality:o=.92,background:u}=e;if(!t)throw new Error("[zag-js > getDataUrl]: Could not find the svg element");const d=Y(t),w=d.document,a=t.getBoundingClientRect(),f=t.cloneNode(!0);f.hasAttribute("viewBox")||f.setAttribute("viewBox",`0 0 ${a.width} ${a.height}`);const N=`<?xml version="1.0" standalone="no"?>\r
`+new d.XMLSerializer().serializeToString(f),v="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(N);if(r==="image/svg+xml")return Promise.resolve(v).then(S=>(f.remove(),S));const l=d.devicePixelRatio||1,i=w.createElement("canvas"),m=new d.Image;m.src=v,i.width=a.width*l,i.height=a.height*l;const h=i.getContext("2d");return(r==="image/jpeg"||u)&&(h.fillStyle=u||"white",h.fillRect(0,0,i.width,i.height)),new Promise(S=>{m.onload=()=>{h==null||h.drawImage(m,0,0,i.width,i.height),S(i.toDataURL(r,o)),f.remove()}})}function mt(t){return t?Array.isArray(t)?t:[t]:[]}var J=t=>(t==null?void 0:t.constructor.name)==="Array",ht=(t,e)=>{if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!M(t[r],e[r]))return!1;return!0},M=(t,e)=>{if(Object.is(t,e))return!0;if(t==null&&e!=null||t!=null&&e==null)return!1;if(typeof(t==null?void 0:t.isEqual)=="function"&&typeof(e==null?void 0:e.isEqual)=="function")return t.isEqual(e);if(typeof t=="function"&&typeof e=="function")return t.toString()===e.toString();if(J(t)&&J(e))return ht(Array.from(t),Array.from(e));if(typeof t!="object"||typeof e!="object")return!1;const r=Object.keys(e??Object.create(null)),o=r.length;for(let u=0;u<o;u++)if(!Reflect.has(t,r[u]))return!1;for(let u=0;u<o;u++){const d=r[u];if(!M(t[d],e[d]))return!1}return!0},Et=t=>typeof t=="string",q=t=>typeof t=="function",Rt=Function.prototype.toString;Rt.call(Object);var St=t=>t();function et(t){if(!xt(t)||t===void 0)return t;const e=Reflect.ownKeys(t).filter(o=>typeof o=="string"),r={};for(const o of e){const u=t[o];u!==void 0&&(r[o]=et(u))}return r}var xt=t=>t&&typeof t=="object"&&t.constructor===Object;function Q(...t){t.length===1?t[0]:t[1],t.length===2&&t[0]}function At(t,e){if(t==null)throw new Error(e())}function Ct(t,e,r){let o=[],u;return d=>{const w=t(d);return(w.length!==o.length||w.some((f,E)=>!M(o[E],f)))&&(o=w,u=e(...w)),u}}var D=(t=>(t.NotStarted="Not Started",t.Started="Started",t.Stopped="Stopped",t))(D||{}),I="__init__";function Nt(t){const e=()=>{var a;return((a=t.getRootNode)==null?void 0:a.call(t))??document},r=()=>yt(e()),o=()=>r().defaultView??window,u=()=>wt(e());return{...t,getRootNode:e,getDoc:r,getWin:o,getActiveElement:u,isActiveElement:a=>a===u(),getById:a=>e().getElementById(a)}}function Tt(t){return new Proxy({},{get(e,r){return r==="style"?o=>t({style:o}).style:t}})}var $t=()=>t=>Array.from(new Set(t)),Dt=j("qr-code").parts("root","frame","pattern","overlay","downloadTrigger"),V=Dt.build(),Ot=t=>{var e;return((e=t.ids)==null?void 0:e.root)??`qrcode:${t.id}:root`},rt=t=>{var e;return((e=t.ids)==null?void 0:e.frame)??`qrcode:${t.id}:frame`},nt=t=>t.getById(rt(t));function It(t,e){const{context:r,computed:o,send:u,scope:d,prop:w}=t,a=o("encoded"),f=w("pixelSize"),E=a.size*f,N=a.size*f,v=[];for(let l=0;l<a.size;l++)for(let i=0;i<a.size;i++){const m=i*f,h=l*f;a.data[l][i]&&v.push(`M${m},${h}h${f}v${f}h-${f}z`)}return{value:r.get("value"),setValue(l){u({type:"VALUE.SET",value:l})},getDataUrl(l,i){const m=nt(d);return tt(m,{type:l,quality:i})},getRootProps(){return e.element({id:Ot(d),...V.root.attrs,style:{"--qrcode-pixel-size":`${f}px`,"--qrcode-width":`${N}px`,"--qrcode-height":`${E}px`,position:"relative"}})},getFrameProps(){return e.svg({id:rt(d),...V.frame.attrs,xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${N} ${E}`})},getPatternProps(){return e.path({d:v.join(""),...V.pattern.attrs})},getOverlayProps(){return e.element({...V.overlay.attrs,style:{position:"absolute",top:"50%",left:"50%",translate:"-50% -50%"}})},getDownloadTriggerProps(l){return e.button({type:"button",...V.downloadTrigger.attrs,onClick(i){i.defaultPrevented||u({type:"DOWNLOAD_TRIGGER.CLICK",...l})}})}}}var Lt={props({props:t}){return{defaultValue:"",pixelSize:10,...t}},initialState(){return"idle"},context({prop:t,bindable:e}){return{value:e(()=>({value:t("value"),defaultValue:t("defaultValue"),onChange(r){var o;(o=t("onValueChange"))==null||o({value:r})}}))}},computed:{encoded:Ct(({context:t,prop:e})=>[t.get("value"),e("encoding")],(t,e)=>ct(t,e))},states:{idle:{on:{"VALUE.SET":{actions:["setValue"]},"DOWNLOAD_TRIGGER.CLICK":{actions:["downloadQrCode"]}}}},implementations:{actions:{setValue({context:t,event:e}){t.set("value",e.value)},downloadQrCode({event:t,scope:e}){const{mimeType:r,quality:o,fileName:u}=t,d=nt(e),w=e.getDoc();tt(d,{type:r,quality:o}).then(a=>{const f=w.createElement("a");f.href=a,f.rel="noopener",f.download=u,f.click(),setTimeout(()=>{f.remove()},0)})}}}};$t()(["ids","defaultValue","value","id","encoding","dir","getRootNode","onValueChange","pixelSize"]);var ot=typeof globalThis.document<"u"?p.useLayoutEffect:p.useEffect;function b(t){const e=t().value??t().defaultValue,r=t().isEqual??Object.is,[o]=p.useState(e),[u,d]=p.useState(o),w=t().value!==void 0,a=p.useRef(u);a.current=w?t().value:u;const f=p.useRef(a.current);ot(()=>{f.current=a.current},[u,t().value]);const E=v=>{var m,h;const l=f.current,i=q(v)?v(l):v;t().debug&&console.log(`[bindable > ${t().debug}] setValue`,{next:i,prev:l}),w||d(i),r(i,l)||(h=(m=t()).onChange)==null||h.call(m,i,l)};function N(){return w?t().value:u}return{initial:o,ref:a,get:N,set(v){(t().sync?L.flushSync:St)(()=>E(v))},invoke(v,l){var i,m;(m=(i=t()).onChange)==null||m.call(i,v,l)},hash(v){var l,i;return((i=(l=t()).hash)==null?void 0:i.call(l,v))??String(v)}}}b.cleanup=t=>{p.useEffect(()=>t,[])};b.ref=t=>{const e=p.useRef(t);return{get:()=>e.current,set:r=>{e.current=r}}};function Vt(t){const e=p.useRef(t);return{get(r){return e.current[r]},set(r,o){e.current[r]=o}}}var qt=(t,e)=>{const r=p.useRef(!1),o=p.useRef(!1);p.useEffect(()=>{if(r.current&&o.current)return e();o.current=!0},[...(t??[]).map(u=>typeof u=="function"?u():u)]),p.useEffect(()=>(r.current=!0,()=>{r.current=!1}),[])};function Mt(t,e={}){var W,K,G,Z;const r=p.useMemo(()=>{const{id:s,ids:n,getRootNode:c}=e;return Nt({id:s,ids:n,getRootNode:c})},[e]),o=(...s)=>{t.debug&&console.log(...s)},u=((W=t.props)==null?void 0:W.call(t,{props:et(e),scope:r}))??e,d=zt(u),w=(K=t.context)==null?void 0:K.call(t,{prop:d,bindable:b,scope:r,flush:H,getContext(){return f},getComputed(){return z},getRefs(){return h}}),a=st(w),f={get(s){var n;return(n=a.current)==null?void 0:n[s].ref.current},set(s,n){var c;(c=a.current)==null||c[s].set(n)},initial(s){var n;return(n=a.current)==null?void 0:n[s].initial},hash(s){var c,g;const n=(c=a.current)==null?void 0:c[s].get();return(g=a.current)==null?void 0:g[s].hash(n)}},E=p.useRef(new Map),N=p.useRef(null),v=p.useRef(null),l=p.useRef({type:""}),i=()=>({...l.current,current(){return l.current},previous(){return v.current}}),m=()=>({...x,matches(...s){return s.includes(x.ref.current)},hasTag(s){var n,c;return!!((c=(n=t.states[x.ref.current])==null?void 0:n.tags)!=null&&c.includes(s))}}),h=Vt(((G=t.refs)==null?void 0:G.call(t,{prop:d,context:f}))??{}),S=()=>({state:m(),context:f,event:i(),prop:d,send:F,action:T,guard:P,track:qt,refs:h,computed:z,flush:H,scope:r,choose:B}),T=s=>{const n=q(s)?s(S()):s;if(!n)return;const c=n.map(g=>{var R,C;const y=(C=(R=t.implementations)==null?void 0:R.actions)==null?void 0:C[g];return y||Q(`[zag-js] No implementation found for action "${JSON.stringify(g)}"`),y});for(const g of c)g==null||g(S())},P=s=>{var n,c;return q(s)?s(S()):(c=(n=t.implementations)==null?void 0:n.guards)==null?void 0:c[s](S())},_=s=>{const n=q(s)?s(S()):s;if(!n)return;const c=n.map(y=>{var C,A;const R=(A=(C=t.implementations)==null?void 0:C.effects)==null?void 0:A[y];return R||Q(`[zag-js] No implementation found for effect "${JSON.stringify(y)}"`),R}),g=[];for(const y of c){const R=y==null?void 0:y(S());R&&g.push(R)}return()=>g.forEach(y=>y==null?void 0:y())},B=s=>mt(s).find(n=>{let c=!n.guard;return Et(n.guard)?c=!!P(n.guard):q(n.guard)&&(c=n.guard(S())),c}),z=s=>{At(t.computed,()=>"[zag-js] No computed object found on machine");const n=t.computed[s];return n({context:f,event:i(),prop:d,refs:h,scope:r,computed:z})},x=b(()=>({defaultValue:t.initialState({prop:d}),onChange(s,n){var g,y,R,C;if(n){const A=E.current.get(n);A==null||A(),E.current.delete(n)}n&&T((g=t.states[n])==null?void 0:g.exit),T((y=N.current)==null?void 0:y.actions);const c=_((R=t.states[s])==null?void 0:R.effects);if(c&&E.current.set(s,c),n===I){T(t.entry);const A=_(t.effects);A&&E.current.set(I,A)}T((C=t.states[s])==null?void 0:C.entry)}})),U=p.useRef(void 0),O=p.useRef(D.NotStarted);ot(()=>{queueMicrotask(()=>{const c=O.current===D.Started;O.current=D.Started,o(c?"rehydrating...":"initializing...");const g=U.current??x.initial;x.invoke(g,c?x.get():I)});const s=E.current,n=x.ref.current;return()=>{o("unmounting..."),U.current=n,O.current=D.Stopped,s.forEach(c=>c==null?void 0:c()),E.current=new Map,N.current=null,queueMicrotask(()=>{T(t.exit)})}},[]);const ut=()=>"ref"in x?x.ref.current:x.get(),F=s=>{queueMicrotask(()=>{var C,A;if(O.current!==D.Started)return;v.current=l.current,l.current=s,o("send",s);let n=ut();const c=((C=t.states[n].on)==null?void 0:C[s.type])??((A=t.on)==null?void 0:A[s.type]),g=B(c);if(!g)return;N.current=g;const y=g.target??n;o("transition",g);const R=y!==n;R?L.flushSync(()=>x.set(y)):g.reenter&&!R?x.invoke(n,n):T(g.actions??[])})};return(Z=t.watch)==null||Z.call(t,S()),{state:m(),send:F,context:f,prop:d,scope:r,refs:h,computed:z,event:i(),getStatus:()=>O.current}}function st(t){const e=p.useRef(t);return e.current=t,e}function zt(t){const e=st(t);return function(o){return e.current[o]}}function H(t){queueMicrotask(()=>{L.flushSync(()=>t())})}var Pt=Tt(t=>t);export{It as c,Lt as m,Pt as n,Mt as u};
